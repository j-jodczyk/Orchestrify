# What has been done
- Literature overview - summary in LiteratureOverview.md.
- Original implementation from the MMM paper is not publically available.
    - The authors only shared a Jupiter notebook with [demo](https://colab.research.google.com/drive/10ZAdEwHDbL1lVcUGeCdj9FxXnQSNFSH4?usp=sharing) program.
    - From demo code it is possible to retrieve:
        - original model
        - code for API - written in Torch C++.
- Attempts to use the original model were made - notebooks `mmm_experiments_01`, `mmm_experiments_02`, `mmm_experiments_03` but were unsuccessful.
- An unofficial implementation of the model was found - https://github.com/AI-Guru/MMM-JSB/.
    - The implementation seems to be consistant with the paper:
        - Generated tokens are how the paper described.
        - The model is GPT2 from Hugging Facr Transformers library with 8 additional heads, 6 layers, embeddings of size 512. The only difference is a smaller attention window size - 1024 (original had 2048).
    - The implementation uses Bach Horales for training.
- The unofficial impelmentation was sucessfully used to generate audio (demo).
- The code has been modified to use other datasets and a script for performing transfer learing has been created. (No results yet).

# Demo
- Generating a midi file using trained model.
- Current set up:
    - user input through a config JSON file containing fields:
        - `midi_path` - path to input midi file
        - `model` - model to be used (currently the only one available is `Bach_Horale` - model trained purely on Bach Horales Dataset)
        - `output_path` - path to the directory, where the output file should be saved
        - `density` - what density should be used
    - if midi contains more than one instrument, the user is prompted to pick one
    - piano roll and syntesized audio can be generated by running `visualization.ipynb` notebook


# What are our next steps
- Train AI Guru implementation on [Lakh Clean dataset](https://www.kaggle.com/datasets/imsparsh/lakh-midi-clean)
- Transfer learn the model on serveral music ganras (for example [Jazz](https://www.kaggle.com/datasets/saikayala/jazz-ml-ready-midi))
- Compare the performance of Lakh-trained model and ganre-trained model on the same midi file.
- Create a website for interacting with models to give a user friendly interface.
